<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Layout Demo</title>
    <script type="module" src="./is-auth.js"></script>
    <script type="module" src="./sidebar.js"></script>
    <script type="module" src="./admin-layout.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'Inter', sans-serif;
        }
        
        /* Pour la démo, simulons un token */
        #setup-token {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #6466f1;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            z-index: 100;
        }
    </style>
</head>
<body>
    <!-- Bouton pour simuler l'authentification (pour la démo) -->
    <button id="setup-token" style="background: #007ace; color: white;">Setup Auth Token</button>
    
    <!-- Composant IsAuth qui vérifie l'authentification -->
    <is-auth redirect-url="/login">
        <!-- Le contenu protégé est ici -->
        <admin-layout page-title="Dashboard" show-pebbles>
            <div>
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                    <h2 style="font-size: 1.5rem; font-weight: 600; color: #1f2937; margin: 0;">Welcome to your Admin Dashboard</h2>
                    <button style="background: #007ace; color: white; border: none; padding: 0.5rem 1rem; border-radius: 0.5rem; cursor: pointer; display: flex; align-items: center; gap: 0.5rem;">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                        </svg>
                        Add New
                    </button>
                </div>
                <p style="color: #6b7280; margin-top: 0;">This content is protected and only visible to authenticated users.</p>
                
                <div style="margin-top: 20px; display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                    <div style="padding: 1.5rem; background: white; border-radius: 0.75rem; border: 1px solid #e5e7eb; box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1);">
                        <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.5rem;">
                            <svg class="w-6 h-6" style="color: #007ace;" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
                            </svg>
                            <h3 style="font-size: 1.125rem; font-weight: 600; color: #1f2937; margin: 0;">Users</h3>
                        </div>
                        <p style="font-size: 2rem; font-weight: 700; color: #1f2937; margin: 0;">1,234</p>
                        <p style="color: #6b7280; font-size: 0.875rem; margin: 0.25rem 0 0 0;">Active users</p>
                    </div>
                    
                    <div style="padding: 1.5rem; background: white; border-radius: 0.75rem; border: 1px solid #e5e7eb; box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1);">
                        <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.5rem;">
                            <svg class="w-6 h-6" style="color: #10b981;" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
                            </svg>
                            <h3 style="font-size: 1.125rem; font-weight: 600; color: #1f2937; margin: 0;">Revenue</h3>
                        </div>
                        <p style="font-size: 2rem; font-weight: 700; color: #1f2937; margin: 0;">$45,678</p>
                        <p style="color: #6b7280; font-size: 0.875rem; margin: 0.25rem 0 0 0;">Monthly revenue</p>
                    </div>
                    
                    <div style="padding: 1.5rem; background: white; border-radius: 0.75rem; border: 1px solid #e5e7eb; box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1);">
                        <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.5rem;">
                            <svg class="w-6 h-6" style="color: #f59e0b;" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                            </svg>
                            <h3 style="font-size: 1.125rem; font-weight: 600; color: #1f2937; margin: 0;">Sessions</h3>
                        </div>
                        <p style="font-size: 2rem; font-weight: 700; color: #1f2937; margin: 0;">42</p>
                        <p style="color: #6b7280; font-size: 0.875rem; margin: 0.25rem 0 0 0;">Active sessions</p>
                    </div>
                </div>
            </div>
        </admin-layout>
    </is-auth>
    
    <script>
        // Pour la démo, ajoutons un bouton pour simuler l'authentification
        document.getElementById('setup-token').addEventListener('click', function() {
            localStorage.setItem('parseToken', 'demo-token-' + Date.now());
            alert('Auth token set! Refresh the page to see the admin layout.');
        });
        
        // Vérifier si on est sur la page de login pour montrer comment gérer la redirection
        if (window.location.pathname === '/login') {
            const urlParams = new URLSearchParams(window.location.search);
            const redir = urlParams.get('redir');
            if (redir) {
                document.body.innerHTML = `
                    <div style="padding: 20px; max-width: 400px; margin: 50px auto; background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                        <h2 style="margin-top: 0;">Login</h2>
                        <p>You need to authenticate to access: ${redir}</p>
                        <button id="login-btn" style="background: #007ace; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer;">Login</button>
                    </div>
                `;
                
                document.getElementById('login-btn').addEventListener('click', function() {
                    localStorage.setItem('parseToken', 'demo-token-' + Date.now());
                    window.location.href = redir || '/dashboard';
                });
            }
        }
    </script>
</body>
</html>